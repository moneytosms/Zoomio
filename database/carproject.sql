-- phpMyAdmin SQL Dump
-- version 5.1.1
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Aug 13, 2022 at 08:41 PM
-- Server version: 10.4.22-MariaDB
-- PHP Version: 8.0.13

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `carproject`
--

-- Create database and schema for carproject with idempotent statements.
CREATE DATABASE IF NOT EXISTS `carproject` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE `carproject`;

-- Admins table
CREATE TABLE IF NOT EXISTS `admin` (
  `ADMIN_ID` VARCHAR(100) NOT NULL PRIMARY KEY,
  `ADMIN_PASSWORD` VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Seed admin
INSERT INTO `admin` (`ADMIN_ID`,`ADMIN_PASSWORD`) VALUES
('admin','admin123')
ON DUPLICATE KEY UPDATE ADMIN_PASSWORD=VALUES(ADMIN_PASSWORD);

-- Users table
CREATE TABLE IF NOT EXISTS `users` (
  `EMAIL` VARCHAR(255) NOT NULL PRIMARY KEY,
  `FNAME` VARCHAR(100) NOT NULL,
  `LNAME` VARCHAR(100) NOT NULL,
  `LIC_NUM` VARCHAR(64) DEFAULT NULL,
  `PHONE_NUMBER` BIGINT DEFAULT NULL,
  `PASSWORD` VARCHAR(255) NOT NULL,
  `GENDER` VARCHAR(20) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Seed users (dummy data)
INSERT INTO `users` (`EMAIL`,`FNAME`,`LNAME`,`LIC_NUM`,`PHONE_NUMBER`,`PASSWORD`,`GENDER`) VALUES
('alice@example.com','Alice','Walker','LIC-A100',9876501234,'passwordAlice','female'),
('bob@example.com','Bob','Ramirez','LIC-B200',9876505678,'passwordBob','male'),
('carol@example.com','Carol','Singh','LIC-C300',9876509012,'passwordCarol','female')
ON DUPLICATE KEY UPDATE FNAME=VALUES(FNAME);

-- Cars table
CREATE TABLE IF NOT EXISTS `cars` (
  `CAR_ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `CAR_NAME` VARCHAR(150) NOT NULL,
  `FUEL_TYPE` VARCHAR(50) NOT NULL,
  `CAPACITY` INT NOT NULL,
  `PRICE` INT NOT NULL,
  `CAR_IMG` VARCHAR(255) DEFAULT NULL,
  `AVAILABLE` ENUM('Y','N') DEFAULT 'Y'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Seed cars (dummy)
INSERT INTO `cars` (`CAR_NAME`,`FUEL_TYPE`,`CAPACITY`,`PRICE`,`CAR_IMG`,`AVAILABLE`) VALUES
('Ferrari F8','Petrol',2,25000,'ferrari.jpg','Y'),
('Lamborghini Huracan','Petrol',2,30000,'lamborghini.webp','Y'),
('Toyota Swift','Diesel',5,1200,'swift.jpg','Y'),
('Hyundai Creta','Petrol',5,2000,'creta.jpg','Y')
ON DUPLICATE KEY UPDATE CAR_NAME=VALUES(CAR_NAME);

-- Booking table
CREATE TABLE IF NOT EXISTS `booking` (
  `BOOK_ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `CAR_ID` INT NOT NULL,
  `EMAIL` VARCHAR(255) NOT NULL,
  `BOOK_PLACE` VARCHAR(255) NOT NULL,
  `BOOK_DATE` DATE NOT NULL,
  `DURATION` INT NOT NULL,
  `PHONE_NUMBER` BIGINT DEFAULT NULL,
  `DESTINATION` VARCHAR(255) DEFAULT NULL,
  `RETURN_DATE` DATE DEFAULT NULL,
  `PRICE` INT DEFAULT 0,
  `BOOK_STATUS` VARCHAR(100) NOT NULL DEFAULT 'UNDER PROCESSING',
  FOREIGN KEY (`CAR_ID`) REFERENCES `cars`(`CAR_ID`) ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (`EMAIL`) REFERENCES `users`(`EMAIL`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Sample bookings
INSERT INTO `booking` (`CAR_ID`,`EMAIL`,`BOOK_PLACE`,`BOOK_DATE`,`DURATION`,`PHONE_NUMBER`,`DESTINATION`,`RETURN_DATE`,`PRICE`,`BOOK_STATUS`) VALUES
(1,'alice@example.com','Bengaluru','2025-10-01',3,9876501234,'Mysore','2025-10-04',7500,'UNDER PROCESSING')
ON DUPLICATE KEY UPDATE BOOK_STATUS=VALUES(BOOK_STATUS);

-- Payment table
CREATE TABLE IF NOT EXISTS `payment` (
  `PAY_ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `BOOK_ID` INT NOT NULL UNIQUE,
  `CARD_NO` VARCHAR(32) NOT NULL,
  `EXP_DATE` VARCHAR(10) NOT NULL,
  `CVV` INT NOT NULL,
  `PRICE` INT NOT NULL,
  FOREIGN KEY (`BOOK_ID`) REFERENCES `booking`(`BOOK_ID`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Feedback table
CREATE TABLE IF NOT EXISTS `feedback` (
  `FED_ID` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `EMAIL` VARCHAR(255) NOT NULL,
  `COMMENT` TEXT,
  FOREIGN KEY (`EMAIL`) REFERENCES `users`(`EMAIL`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Finalize
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
  `PAY_ID` int(11) NOT NULL,
